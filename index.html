<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>20kb.js</title>
	<script src="js/CSSClass.min.js"></script>
	<style>
		body {
			display: flex;
			align-items: center;
			justify-content: center;
		}
		#ga {
			display: grid;
			background: #999;
			background: url(img/grass.gif),
						linear-gradient(135deg, rgba(0,128,0,1) 0%, rgba(0,255,162,1) 100%);
			background-blend-mode: multiply;
			grid-template-columns: repeat(11, 50px);
			grid-template-rows: repeat(11, 50px);
			grid-gap: 2px;
			width: 570px;
			height: 570px;
			position: relative;
			transform: rotateX(60deg) rotateZ(45deg);
		}
		#ga::before {
			content: '';
			display: block;
			width: 30px;
			height: 570px;
			position: absolute;
			bottom: -30px;
			right: -30px;
			background: #333;
			transform: translateY(-15px) skewY(45deg);
		}
		#ga::after {
			content: '';
			display: block;
			width: 570px;
			height: 30px;
			position: absolute;
			bottom: -30px;
			left: 0;
			background: #666;
			transform: translateX(15px) skewX(45deg);
		}
		#ga > div {
			background: rgba(255,255,255,0.3);
			display: flex;
			align-items: center;
			justify-content: center;
		}
		#ga > div:hover {
			background: rgba(255,255,240,0.6);
		}
		#x0y0 {
			background: blue !important;
		}
		i,b {
			display: block;
			width: 32px;
			height: 32px;
			font-style: normal;
			transform-origin: center bottom;
			transform: rotateZ(-45deg) rotateY(60deg) translateX(50%) translateY(25%) scale(4);
			image-rendering: pixelated;
		}
		b {
			transform: rotateZ(-45deg) rotateY(60deg) scale(5) translateX(13px) translateY(11px);
			filter: hue-rotate(30deg);
		}
		i:hover,
		div:hover > i{
			filter: brightness(1.25)
					drop-shadow(1px 1px 0 yellow)
					drop-shadow(-1px -1px 0 yellow);
		}
		.mine {
			background: url(img/mush.gif) no-repeat;
			width: 16px;
			height: 16px;
		}
		.goblin {
			background: url(img/goblins.gif) no-repeat;
			width: 18px;
			height: 24px;
		}
		.fireskull {
			background: url(img/fireskulls.gif) no-repeat;
			width: 18px;
			height: 24px;
		}
		.priest {
			background: url(img/priests.gif) no-repeat;
			width: 24px;
			height: 32px;
		}
		.golem {
			background: url(img/golem.gif) no-repeat;
			width: 32px;
			height: 32px;
		}
		.queen {
			background: url(img/lords.gif) no-repeat;
			width: 32px;
			height: 32px;
		}
		.king {
			background: url(img/blueguys.gif) no-repeat;
			width: 34px;
			height: 34px;
		}
		.nn { background-position: 0 33.3%; }
		.ne {}
		.ee { background-position: 0 66.7%; }
		.se {}
		.ss { background-position: 0 0; }		/* default */
		.sw {}
		.ww { background-position: 0 66.7%; }	/* flipX transform - how? */
		.nw {}
	</style>
</head>
<body>
	<div id="ga">
	</div>
	<script language="javascript">
		Array.prototype.random = function() {
			return this[Math.floor(Math.random() * this.length)];
		};
		// Aliases
		var d = document;
		d.e = d.createElement;
		d.q = d.querySelector;

		// Unicode icons:
		const PIECES = ["🤖","👻","😈","👹","🦄","🐲","🐍","💣","🕸️","🏂"];
		const WEAP = ["🔪","🗡️","🔫","⛏️","⛸️","💥","🔥"];
		const TERR = ["🎄","🌲","🌳","🌵"]
		const DIRS = ["⬆️","↗️","➡️","↘️","⬇️","↙️","⬅️","↖️"];

		var $ga = document.querySelector("#ga");
		// Build board:
		for (var y=0; y<11; y++) {
			for (var x=0; x<11; x++) {
				var div = document.createElement("div");
				var canv = document.createElement('canvas');
				canv.width = 32;
				canv.height = 32;
				if (x !== y && Math.random() > 0.85) div.innerHTML = `<b>${TERR.random()}</b>`;
				$ga.appendChild(div);
				div.setAttribute("id", "x"+x+"y"+y);
				div.style.zIndex = x + y;	// (0,0) will be furthest away square
				//var ctx = canv.getContext('2d');
				//ctx.font = '32px serif';
				//ctx.fillText(WEAP[0], 10, 50);
				//ctx.fillText(PIECES[0], 10, 50);
			}
		}

		function piece(className, team=0) {
			return d.e('i').addClass(className);
		}

		function placeAt(x, y, type, team) {
			d.q("#x"+x+"y"+y).appendChild(piece(type, team));
		}

		placeAt(0,0,'mine');
		placeAt(3,3,'king');
		placeAt(4,4,'queen');
		placeAt(5,5,'gunner');
		placeAt(6,6,'priest');
		placeAt(7,7,'goblin');
		placeAt(8,8,'fireskull');

	</script>
</body>
<html>
<!--
TODO
x & y animation
jumping animation
explosions -> animate filter: blur(px) scale?
attacking effect/frame
hue change team 2
randomise cell colour
tool: facing direction change
tool: spawn from toolbox
tool: orders 1,2,3
ui: health overlays
ui: cursors

-->
