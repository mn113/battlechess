!function(t,r){function i(t,r){t.push.apply(t,r?"[object Array]"=={}.toString.call(r)?r:[r]:[])}function s(t,r,i){for(var s=0,n=t.length;n>s;++s)t[s].call(r,i)}function n(t){return this instanceof n?(this.object=t.object,this.property=t.property,this.from=this._from=t.from||this.object[this.property],this.to="[object Array]"=={}.toString.call(t.to)?t.to:[t.to],this.target=0,this.parser=t.parser||function(t){var r,i,s,e=n.Parsers,h=[]
for(i in e)e.hasOwnProperty(i)&&h.push(e[i])
for(h.sort(function(t,r){return(r.priority||0)-(t.priority||0)}),i=0,s=h.length;s>i;++i)if(r=new h[i],null!=r.parse(t))return r
return r=new e.Number,r.parse(t),r}(this.from),this.transition=t.transition||n.Transitions.linear,this.duration=t.duration||500,this.fps=t.fps||40,this.frameInterval=1e3/this.fps,this.frames=t.frames||~~(this.duration/this.frameInterval+.5),this.frame=t.frame==r?-1:0,this.running=!1,this.startHandlers=[],this.updateHandlers=[],this.finishHandlers=[],i(this.startHandlers,t.start),i(this.updateHandlers,t.update),i(this.finishHandlers,t.finish),r):new n(t)}function e(t,r,i){return(r-t)*i+t}var h,a,o=n.prototype,u=t.Viper
o.start=function(){return this.running||(this.resume(),s(this.startHandlers,this,this.object)),this},o.stop=function(){return this.running&&(this.pause(),s(this.finishHandlers,this,this.object)),this},o.pause=function(t){if(this.running){this.running=this.time=!1,clearInterval(this.timer)
var i=this
t!=r&&setTimeout(function(){i.resume()},t)}return this},o.resume=function(){if(!this.running&&this.frame<this.frames){var t=this
this.timer=setInterval(function(){t.step(+new Date)},this.frameInterval),this.running=!0}return this},o.step=function(t){this.frame+=(t-(this.time||t))/this.frameInterval,this.time=t,this.object[this.property]=this.parser.compute(this.from,this.to[this.target],this.frame<this.frames?this.transition(this.frame/this.frames):1),s(this.updateHandlers,this,this.object),this.frame>=this.frames&&(this.frame=this.time=0,this.parser.parse(this.from=this.to[this.target++]),this.to[this.target]==r&&(this.parser.parse(this.from=this._from),this.target=0,this.stop()))},n.Transitions={linear:function(t){return t},sine:function(t){return 1-Math.cos(t*Math.PI/2)},elastic:function(t){return Math.pow(2,10*--t)*Math.cos(20*t*Math.PI/3)},bounce:function(t){for(var r,i=0,s=1;(7-4*i)/11>t;)i+=s,s/=2
return r=(11-6*i-11*t)/4,s*s-r*r}}
for(a in n.Transitions)n.Transitions.hasOwnProperty(a)&&(h=n.Transitions[a],h.out=function(t){return function(r){return 1-t(1-r)}}(h),h.inOut=function(t){return function(r){return(r>.5?2-t(2*(1-r)):t(2*r))/2}}(h))
n.Parsers={Number:function(){this.parse=function(t,i){t+=""
var s=/(\D*)(\d+)(.*)?/.exec(t)||[,,NaN],n=parseFloat(s[2])
return i||(this.prefix=s[1]||"",this.suffix=s[3]||"",this.value=n),isNaN(n)?r:n},this.compute=function(t,r,i){return this.prefix+e(this.value,this.parse(r,!0),i)+this.suffix}},Color:function(){this.parse=function(t,r){var i,s=parseInt
return/^#[\da-f]{6}$/i.test(t)?i=[s(t.substring(1,3),16),s(t.substring(3,5),16),s(t.substring(5,7),16)]:(i=/^(rgb\()?(\d+),\s*(\d+),\s*(\d+)\)?$/.exec(t))&&(i=[s(i[2]),s(i[3]),s(i[4])]),r||(this.value=i),i},this.compute=function(t,r,i){for(var s=[],n=this.parse(r,!0),h=0,a=this.value.length;a>h;++h)s.push(~~(e(this.value[h],n[h],i)+.5))
return"rgb("+s+")"}},String:function(){this.parse=function(t){return""+t},this.compute=function(t,r,i){t+="",r+=""
var s=~~(r.length*i+.5)
return r.substr(0,s)+t.substr(s,t.length-s-~~((t.length-r.length)*i+.5))}}},n.Parsers.Color.priority=1,n.Parsers.String.priority=-9,n.noConflict=function(){return t.Viper=u,n},t.Viper=n}(this)
